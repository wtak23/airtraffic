


<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Create lookup-table</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <link rel="stylesheet" href="_static/font-awesome-4.7.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="" href="index.html" />
    <link rel="up" title="Other Data munging (elbow grease required!)" href="data_munging.html" />
    <link rel="next" title="BeautifulSoup to extract US State population" href="webscrape_beautifulsoup.html" />
    <link rel="prev" title="Other Data munging (elbow grease required!)" href="data_munging.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          US Airport Traffic Analysis</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="http://takwatanabe.me/resume.pdf"><i class="fa fa-spotify" aria-hidden="true"></i>&nbsp; resume</a></li>
                <li><a href="https://github.com/wtak23/airtraffic"><i class="fa fa-github" aria-hidden="true"></i>&nbsp; Codes</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Contents <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="flight-count-analysis.html">Part 1. Air-traffic Count Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flight-count-analysis.html#load-and-explore-dataset">Load and explore dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="flight-count-analysis.html#create-timeseries-of-daily-flight-counts">Create Timeseries of Daily Flight Counts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#create-interactive-plot-with-plotly-cufflinks">Create interactive plot with plotly/cufflinks</a></li>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#study-seasonal-trend-with-rolling-averaged-timeseries">Study seasonal trend with rolling-averaged timeseries</a></li>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#narrow-focus-on-honolulu-airport">Narrow focus on Honolulu Airport</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flight-count-analysis.html#flight-counts-study-by-day-of-week-and-month">Flight counts study by &#8220;day_of_week&#8221; and &#8220;month&#8221;</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#over-entire-year-period">Over entire year period</a></li>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#pivoting-analysis-grouped-by-month-and-day-of-week">Pivoting: analysis grouped by month and day_of_week</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flight-count-analysis.html#repeat-analysis-for-ny-la-and-vegas">Repeat analysis for NY, LA, and Vegas.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#data-tidying">Data tidying</a></li>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#plot-results">Plot results</a></li>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#create-sublots-of-monthly-flight-count-trends-for-each-city">Create sublots of monthly flight-count trends for each city</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flight-count-analysis.html#which-state-had-the-most-air-traffics">Which state had the most air traffics?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#id1">Data tidying</a></li>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#choropleth-figure-display-result-on-us-map">Choropleth figure (display result on US map)</a></li>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#choropleth-after-normalizing-over-state-population">Choropleth after normalizing over state population</a></li>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#ignore-nothing-interesting-normalized-flight-counts-at-different-month">(ignore, nothing interesting) Normalized flight-counts at different month?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flight-count-analysis.html#most-frequently-used-airports">Most frequently used airports</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#id2">Data tidying</a></li>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#id3">Plot results</a></li>
<li class="toctree-l3"><a class="reference internal" href="flight-count-analysis.html#display-results-on-us-map">Display results on US Map</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="regressing_out_weekday_effect.html">Part2: Holiday Detection via Flight-Residual Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="regressing_out_weekday_effect.html#aim-of-this-notebook">Aim of this notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="regressing_out_weekday_effect.html#load-data-and-prepare-timeseries">Load data, and prepare Timeseries</a></li>
<li class="toctree-l2"><a class="reference internal" href="regressing_out_weekday_effect.html#regression-analysis-eliminate-effect-from-day-of-week">Regression analysis: eliminate effect from &#8220;day_of_week&#8221;</a><ul>
<li class="toctree-l3"><a class="reference internal" href="regressing_out_weekday_effect.html#fit-ols-model">Fit OLS model</a></li>
<li class="toctree-l3"><a class="reference internal" href="regressing_out_weekday_effect.html#analyze-residual-signal">Analyze residual signal</a></li>
<li class="toctree-l3"><a class="reference internal" href="regressing_out_weekday_effect.html#get-lagged-residual">Get &#8220;Lagged&#8221; residual</a></li>
<li class="toctree-l3"><a class="reference internal" href="regressing_out_weekday_effect.html#histograms-of-the-signals">Histograms of the signals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="regressing_out_weekday_effect.html#repeat-analysis-for-3-years-period">Repeat analysis for 3 years period</a><ul>
<li class="toctree-l3"><a class="reference internal" href="regressing_out_weekday_effect.html#try-overlaying-the-annual-plot">Try overlaying the annual plot</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="network_analysis.html">Part3: Network analysis of 2016 US Air Traffic</a><ul>
<li class="toctree-l2"><a class="reference internal" href="network_analysis.html#overview-network-view-of-the-us-airtraffic-system">Overview: network view of the US Airtraffic System</a></li>
<li class="toctree-l2"><a class="reference internal" href="network_analysis.html#create-the-network-edges-pairs-of-aiports-forming-the-trips">Create the network &#8220;edges&#8221; &#8212; pairs of aiports forming the trips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="network_analysis.html#data-tidying">Data tidying</a></li>
<li class="toctree-l3"><a class="reference internal" href="network_analysis.html#most-frequent-trips-in-us-during-the-past-year">Most frequent &#8220;trips&#8221; in US during the past year</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="network_analysis.html#create-undirected-graph-edges-ignoring-directionality">Create undirected graph &#8211; edges ignoring directionality</a><ul>
<li class="toctree-l3"><a class="reference internal" href="network_analysis.html#id1">Data tidying</a></li>
<li class="toctree-l3"><a class="reference internal" href="network_analysis.html#most-frequent-routes-in-us-during-the-past-year">Most frequent &#8220;routes&#8221; in US during the past year</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="network_analysis.html#overview-complex-networt-study-of-the-us-airport-system">Overview: complex networt study of the US Airport System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="network_analysis.html#make-nx-graph-create-networkx-graph-object">make_nx_graph: create networkx graph object</a></li>
<li class="toctree-l3"><a class="reference internal" href="network_analysis.html#compute-network-measures-network-measures-characterizing-nodes-airport">compute_network_measures: network measures characterizing nodes (airport)</a></li>
<li class="toctree-l3"><a class="reference internal" href="network_analysis.html#other-helper-functions">Other helper functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="network_analysis.html#complex-network-theory-in-action">Complex network theory in action!</a><ul>
<li class="toctree-l3"><a class="reference internal" href="network_analysis.html#power-law-analysis-of-centrality-measures">Power law analysis of centrality measures</a></li>
<li class="toctree-l3"><a class="reference internal" href="network_analysis.html#pagerank-centrality-among-us-airports">PageRank Centrality among US Airports</a></li>
<li class="toctree-l3"><a class="reference internal" href="network_analysis.html#communities-detected-via-modularity-score">Communities Detected via Modularity Score</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="network_analysis.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="data_munging.html">Other Data munging (elbow grease required!)</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Create lookup-table</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aim-of-notebook">Aim of notebook</a></li>
<li class="toctree-l3"><a class="reference internal" href="#load-the-main-airport-traffic-data">Load the main airport traffic data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#load-lookup-table-provided-by-bts">Load lookup table provided by BTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-enhanced-lookuptable">Create <em>enhanced</em> lookuptable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#remove-code-that-is-not-present-our-dataset">Remove Code that is not present our dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parse-state-city-and-airport-name-from-description-field">Parse state,city, and airport-name from &#8216;Description&#8217; field</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-state-region-information">Add state &#8216;region&#8217; information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-airport-latitude-and-longitude-information-using-geocoder">Add airport latitude and longitude information using geocoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-column-with-both-city-and-state">Add column with both city and state</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#all-done-save-dataframe-on-disk">All done. Save dataframe on disk</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="webscrape_beautifulsoup.html">BeautifulSoup to extract US State population</a></li>
<li class="toctree-l2"><a class="reference internal" href="carriers_airports.html">Study <code class="docutils literal"><span class="pre">carriers.xls</span></code> and <code class="docutils literal"><span class="pre">airports</span> <span class="pre">new.xlt</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="carriers_airports.html#study-the-carrier-spreadsheet">Study the &#8220;carrier&#8221; spreadsheet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="carriers_airports.html#sort-out-the-nan-values">sort out the &#8220;nan&#8221; values</a></li>
<li class="toctree-l4"><a class="reference internal" href="carriers_airports.html#filter-away-nans-from-the-dataframe">Filter away nans from the DataFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="carriers_airports.html#realized-some-code-is-treated-as-int-convert-to-string">Realized some <em>Code</em> is treated as int...convert to string</a></li>
<li class="toctree-l4"><a class="reference internal" href="carriers_airports.html#what-s-the-deal-with-the-1-appended-to-some-of-the-entries">What&#8217;s the deal with the (1) appended to some of the entries?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="carriers_airports.html#study-airports-spreadsheet">Study <em>airports</em> spreadsheet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="carriers_airports.html#study-nans">Study nans</a></li>
<li class="toctree-l4"><a class="reference internal" href="carriers_airports.html#filter-out-non-usa-airports">Filter out non-USA airports</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="carriers_airports.html#study-airports-state-distribution">Study &#8220;airports&#8221; state distribution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="carriers_airports.html#plot-bubble-markers-for-all-airports">Plot bubble markers for all airports</a></li>
<li class="toctree-l4"><a class="reference internal" href="carriers_airports.html#take-a-closer-look-at-michigan-my-home-state">Take a closer look at Michigan, my home state</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="test.html">Test SVG and png figures</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">page-contents <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Create lookup-table</a><ul>
<li><a class="reference internal" href="#aim-of-notebook">Aim of notebook</a></li>
<li><a class="reference internal" href="#load-the-main-airport-traffic-data">Load the main airport traffic data</a></li>
<li><a class="reference internal" href="#load-lookup-table-provided-by-bts">Load lookup table provided by BTS</a></li>
<li><a class="reference internal" href="#create-enhanced-lookuptable">Create <em>enhanced</em> lookuptable</a><ul>
<li><a class="reference internal" href="#remove-code-that-is-not-present-our-dataset">Remove Code that is not present our dataset</a></li>
<li><a class="reference internal" href="#parse-state-city-and-airport-name-from-description-field">Parse state,city, and airport-name from &#8216;Description&#8217; field</a></li>
<li><a class="reference internal" href="#add-state-region-information">Add state &#8216;region&#8217; information</a></li>
<li><a class="reference internal" href="#add-airport-latitude-and-longitude-information-using-geocoder">Add airport latitude and longitude information using geocoder</a></li>
<li><a class="reference internal" href="#add-column-with-both-city-and-state">Add column with both city and state</a></li>
</ul>
</li>
<li><a class="reference internal" href="#all-done-save-dataframe-on-disk">All done. Save dataframe on disk</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="create-lookup-table">
<h1>Create lookup-table</h1>
<p>The original ipython notebook can be downloaded from <a class="reference external" href="http://nbviewer.jupyter.org/github/wtak23/airtraffic/blob/master/final_scripts/create_lookup_table.ipynb">here</a> .</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>%matplotlib inline
import pandas as pd
import time
import numpy as np

from pprint import pprint
from util import print_time
</pre></div>
</div>
<div class="section" id="aim-of-notebook">
<h2>Aim of notebook</h2>
<ul class="simple">
<li>The <a class="reference external" href="http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&amp;DB_Short_Name=On-Time">airport traffic
dataset</a>
encodes the airport with unique ID numbers.</li>
<li>In this notebook, we&#8217;ll create an <em>enhanced lookup-table</em> by taking
the lookup table provided by the BTS (<a class="reference external" href="http://www.transtats.bts.gov/Download_Lookup.asp?Lookup=L_AIRPORT_ID">download
link</a>)
and adding additional relevant information regarding the airport
(such as latitude/longitutde info)</li>
</ul>
</div>
<div class="section" id="load-the-main-airport-traffic-data">
<h2>Load the main airport traffic data</h2>
<ul class="simple">
<li>Load 3 years worth of air-traffic data provided by BTS
(<a class="reference external" href="http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&amp;DB_Short_Name=On-Time">link</a>)</li>
<li>(from November 2013 to October 2016)</li>
</ul>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">util</span> <span class="kn">import</span> <span class="n">load_airport_data_3years</span>
<span class="n">df_data</span> <span class="o">=</span> <span class="n">load_airport_data_3years</span><span class="p">()</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span> <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2013</span><span class="o">-</span><span class="mf">11.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2013</span><span class="o">-</span><span class="mf">12.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">01.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">02.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">03.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">04.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">05.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">06.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">07.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">08.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">09.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">10.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">11.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2014</span><span class="o">-</span><span class="mf">12.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">01.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">02.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">03.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">04.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">05.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">06.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">07.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">08.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">09.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">10.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">11.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2015</span><span class="o">-</span><span class="mf">12.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2016</span><span class="o">-</span><span class="mf">01.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2016</span><span class="o">-</span><span class="mf">02.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2016</span><span class="o">-</span><span class="mf">03.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2016</span><span class="o">-</span><span class="mf">04.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2016</span><span class="o">-</span><span class="mf">05.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2016</span><span class="o">-</span><span class="mf">06.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2016</span><span class="o">-</span><span class="mf">07.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2016</span><span class="o">-</span><span class="mf">08.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2016</span><span class="o">-</span><span class="mf">09.</span><span class="n">zip</span>
 <span class="o">...</span> <span class="n">load</span> <span class="n">dataframe</span> <span class="kn">from</span> <span class="mi">2016</span><span class="o">-</span><span class="mf">10.</span><span class="n">zip</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">df_data</span><span class="o">.</span><span class="n">shape</span>
<span class="n">df_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">17364696</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>QUARTER</th>
      <th>MONTH</th>
      <th>DAY_OF_MONTH</th>
      <th>DAY_OF_WEEK</th>
      <th>ORIGIN_AIRPORT_ID</th>
      <th>DEST_AIRPORT_ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2013</td>
      <td>4</td>
      <td>11</td>
      <td>3</td>
      <td>7</td>
      <td>12478</td>
      <td>10693</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2013</td>
      <td>4</td>
      <td>11</td>
      <td>4</td>
      <td>1</td>
      <td>12478</td>
      <td>10693</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2013</td>
      <td>4</td>
      <td>11</td>
      <td>5</td>
      <td>2</td>
      <td>12478</td>
      <td>10693</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2013</td>
      <td>4</td>
      <td>11</td>
      <td>6</td>
      <td>3</td>
      <td>12478</td>
      <td>10693</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013</td>
      <td>4</td>
      <td>11</td>
      <td>7</td>
      <td>4</td>
      <td>12478</td>
      <td>10693</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="load-lookup-table-provided-by-bts">
<h2>Load lookup table provided by BTS</h2>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">df_lookup</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/L_AIRPORT_ID.csv&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">df_lookup</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">6409</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="create-enhanced-lookuptable">
<h2>Create <em>enhanced</em> lookuptable</h2>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">df_lookup</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Code</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10001</td>
      <td>Afognak Lake, AK: Afognak Lake Airport</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10003</td>
      <td>Granite Mountain, AK: Bear Creek Mining Strip</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10004</td>
      <td>Lik, AK: Lik Mining Camp</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10005</td>
      <td>Little Squaw, AK: Little Squaw Airport</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10006</td>
      <td>Kizhuyak, AK: Kizhuyak Bay</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10007</td>
      <td>Klawock, AK: Klawock Seaplane Base</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10008</td>
      <td>Elizabeth Island, AK: Elizabeth Island Airport</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10009</td>
      <td>Homer, AK: Augustin Island</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10010</td>
      <td>Hudson, NY: Columbia County</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10011</td>
      <td>Peach Springs, AZ: Grand Canyon West</td>
    </tr>
  </tbody>
</table>
</div><div class="section" id="remove-code-that-is-not-present-our-dataset">
<h3>Remove Code that is not present our dataset</h3>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># unique ID&#39;s in the dataset</span>
<span class="n">uniq_orig</span> <span class="o">=</span> <span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;ORIGIN_AIRPORT_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">uniq_dest</span> <span class="o">=</span> <span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;DEST_AIRPORT_ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># apply ``set`` function to get unique items in concatenated list</span>
<span class="n">uniq_id</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">uniq_orig</span> <span class="o">+</span> <span class="n">uniq_dest</span><span class="p">))</span>

<span class="k">print</span> <span class="s2">&quot;There are {} Airport-Codes in the lookup table&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df_lookup</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span> <span class="s2">&quot;There are {} unique airport-codes in our dataset&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uniq_id</span><span class="o">.</span><span class="n">__len__</span><span class="p">())</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span>There are 6409 Airport-Codes in the lookup table
There are 334 unique airport-codes in our dataset
</pre></div>
</div>
<p>Let&#8217;s filter/drop the rows/records that we do not need in our analysis</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># only keep the items in the main dataframe</span>
<span class="n">_mask</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span> <span class="n">uniq_id</span> <span class="p">)</span>
<span class="n">df_lookup</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="p">[</span> <span class="n">_mask</span> <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">print</span> <span class="n">df_lookup</span><span class="o">.</span><span class="n">shape</span>
<span class="n">df_lookup</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">334</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Code</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10135</td>
      <td>Allentown/Bethlehem/Easton, PA: Lehigh Valley ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10136</td>
      <td>Abilene, TX: Abilene Regional</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10140</td>
      <td>Albuquerque, NM: Albuquerque International Sun...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10141</td>
      <td>Aberdeen, SD: Aberdeen Regional</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10146</td>
      <td>Albany, GA: Southwest Georgia Regional</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10154</td>
      <td>Nantucket, MA: Nantucket Memorial</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10155</td>
      <td>Waco, TX: Waco Regional</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10157</td>
      <td>Arcata/Eureka, CA: Arcata</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10158</td>
      <td>Atlantic City, NJ: Atlantic City International</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10165</td>
      <td>Adak Island, AK: Adak</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="parse-state-city-and-airport-name-from-description-field">
<h3>Parse state,city, and airport-name from &#8216;Description&#8217; field</h3>
<ul class="simple">
<li>Above we realize that the <code class="docutils literal"><span class="pre">Description</span></code> field contains information
regarding the <em>city</em>, <em>state</em>, and <em>name</em> of the airport.</li>
<li>Let&#8217;s create individual field for each information.</li>
<li>Fortunately, the <code class="docutils literal"><span class="pre">Description</span></code> column uses a comma (<code class="docutils literal"><span class="pre">,</span></code>) and
colon (<code class="docutils literal"><span class="pre">:</span></code>) to delimit the City, State, Airport-name information,
so splitting these are is straightforward.</li>
</ul>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># apply string &quot;split&quot; method to break information up</span>
<span class="n">df_parse</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">splits</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;City&#39;</span><span class="p">:</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;State&#39;</span><span class="p">:</span><span class="n">splits</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;Airport&#39;</span><span class="p">:</span><span class="n">splits</span><span class="p">[</span><span class="mi">4</span><span class="p">]},</span>
               <span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">r&#39;(,\s|:\s)&#39;</span><span class="p">)</span> <span class="p">)</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">df_parse</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="c1"># convert dict to dataframe</span>
<span class="n">df_parse</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_parse</span><span class="p">)</span>
<span class="n">df_parse</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;Airport&#39;</span><span class="p">:</span> <span class="s1">&#39;Lehigh Valley International&#39;</span><span class="p">,</span>
  <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="s1">&#39;Allentown/Bethlehem/Easton&#39;</span><span class="p">,</span>
  <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;PA&#39;</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;Airport&#39;</span><span class="p">:</span> <span class="s1">&#39;Abilene Regional&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="s1">&#39;Abilene&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;TX&#39;</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;Airport&#39;</span><span class="p">:</span> <span class="s1">&#39;Albuquerque International Sunport&#39;</span><span class="p">,</span>
  <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="s1">&#39;Albuquerque&#39;</span><span class="p">,</span>
  <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;NM&#39;</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;Airport&#39;</span><span class="p">:</span> <span class="s1">&#39;Aberdeen Regional&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="s1">&#39;Aberdeen&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;SD&#39;</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;Airport&#39;</span><span class="p">:</span> <span class="s1">&#39;Southwest Georgia Regional&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="s1">&#39;Albany&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="s1">&#39;GA&#39;</span><span class="p">}]</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Airport</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lehigh Valley International</td>
      <td>Allentown/Bethlehem/Easton</td>
      <td>PA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Abilene Regional</td>
      <td>Abilene</td>
      <td>TX</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albuquerque International Sunport</td>
      <td>Albuquerque</td>
      <td>NM</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Aberdeen Regional</td>
      <td>Aberdeen</td>
      <td>SD</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Southwest Georgia Regional</td>
      <td>Albany</td>
      <td>GA</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># now we can readily add these information to our lookup table</span>
<span class="n">df_lookup</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df_parse</span><span class="p">)</span>

<span class="k">print</span> <span class="n">df_lookup</span><span class="o">.</span><span class="n">shape</span>
<span class="n">df_lookup</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">334</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Code</th>
      <th>Description</th>
      <th>Airport</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10135</td>
      <td>Allentown/Bethlehem/Easton, PA: Lehigh Valley ...</td>
      <td>Lehigh Valley International</td>
      <td>Allentown/Bethlehem/Easton</td>
      <td>PA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10136</td>
      <td>Abilene, TX: Abilene Regional</td>
      <td>Abilene Regional</td>
      <td>Abilene</td>
      <td>TX</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10140</td>
      <td>Albuquerque, NM: Albuquerque International Sun...</td>
      <td>Albuquerque International Sunport</td>
      <td>Albuquerque</td>
      <td>NM</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10141</td>
      <td>Aberdeen, SD: Aberdeen Regional</td>
      <td>Aberdeen Regional</td>
      <td>Aberdeen</td>
      <td>SD</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10146</td>
      <td>Albany, GA: Southwest Georgia Regional</td>
      <td>Southwest Georgia Regional</td>
      <td>Albany</td>
      <td>GA</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="add-state-region-information">
<h3>Add state &#8216;region&#8217; information</h3>
<p>I also would like to study patterns among the four-regions in the United
States:</p>
<ol class="arabic simple">
<li>Northeast</li>
<li>South</li>
<li>West</li>
<li>Midwest</li>
</ol>
<p>I saved a json lookup file for this purpose</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>%%bash
cat ../data/us_states_regions.json
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;Northeast&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Connecticut&quot;</span><span class="p">,</span><span class="s2">&quot;Maine&quot;</span><span class="p">,</span> <span class="s2">&quot;Massachusetts&quot;</span><span class="p">,</span> <span class="s2">&quot;New Hampshire&quot;</span><span class="p">,</span> <span class="s2">&quot;Rhode Island&quot;</span><span class="p">,</span> <span class="s2">&quot;Vermont&quot;</span><span class="p">,</span><span class="s2">&quot;New Jersey&quot;</span><span class="p">,</span> <span class="s2">&quot;New York&quot;</span><span class="p">,</span> <span class="s2">&quot;Pennsylvania&quot;</span><span class="p">],</span>
<span class="s2">&quot;Midwest&quot;</span>   <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Illinois&quot;</span><span class="p">,</span> <span class="s2">&quot;Indiana&quot;</span><span class="p">,</span> <span class="s2">&quot;Michigan&quot;</span><span class="p">,</span> <span class="s2">&quot;Ohio&quot;</span><span class="p">,</span> <span class="s2">&quot;Wisconsin&quot;</span><span class="p">,</span> <span class="s2">&quot;Iowa&quot;</span><span class="p">,</span> <span class="s2">&quot;Kansas&quot;</span><span class="p">,</span> <span class="s2">&quot;Minnesota&quot;</span><span class="p">,</span> <span class="s2">&quot;Missouri&quot;</span><span class="p">,</span> <span class="s2">&quot;Nebraska&quot;</span><span class="p">,</span> <span class="s2">&quot;North Dakota&quot;</span><span class="p">,</span> <span class="s2">&quot;South Dakota&quot;</span><span class="p">],</span>
<span class="s2">&quot;South&quot;</span>     <span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;Delaware&quot;</span><span class="p">,</span> <span class="s2">&quot;Florida&quot;</span><span class="p">,</span> <span class="s2">&quot;Georgia&quot;</span><span class="p">,</span> <span class="s2">&quot;Maryland&quot;</span><span class="p">,</span> <span class="s2">&quot;North Carolina&quot;</span><span class="p">,</span> <span class="s2">&quot;South Carolina&quot;</span><span class="p">,</span> <span class="s2">&quot;Virginia&quot;</span><span class="p">,</span> <span class="s2">&quot;District of Columbia&quot;</span><span class="p">,</span> <span class="s2">&quot;West Virginia&quot;</span><span class="p">,</span>             <span class="s2">&quot;Alabama&quot;</span><span class="p">,</span> <span class="s2">&quot;Kentucky&quot;</span><span class="p">,</span> <span class="s2">&quot;Mississippi&quot;</span><span class="p">,</span> <span class="s2">&quot;Tennessee&quot;</span><span class="p">,</span><span class="s2">&quot;Arkansas&quot;</span><span class="p">,</span> <span class="s2">&quot;Louisiana&quot;</span><span class="p">,</span> <span class="s2">&quot;Oklahoma&quot;</span><span class="p">,</span> <span class="s2">&quot;Texas&quot;</span><span class="p">],</span>
<span class="s2">&quot;West&quot;</span>      <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Arizona&quot;</span><span class="p">,</span> <span class="s2">&quot;Colorado&quot;</span><span class="p">,</span> <span class="s2">&quot;Idaho&quot;</span><span class="p">,</span> <span class="s2">&quot;Montana&quot;</span><span class="p">,</span> <span class="s2">&quot;Nevada&quot;</span><span class="p">,</span> <span class="s2">&quot;New Mexico&quot;</span><span class="p">,</span> <span class="s2">&quot;Utah&quot;</span><span class="p">,</span>  <span class="s2">&quot;Wyoming&quot;</span><span class="p">,</span> <span class="s2">&quot;Alaska&quot;</span><span class="p">,</span> <span class="s2">&quot;California&quot;</span><span class="p">,</span> <span class="s2">&quot;Hawaii&quot;</span><span class="p">,</span> <span class="s2">&quot;Oregon&quot;</span><span class="p">,</span> <span class="s2">&quot;Washington&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/us_states_regions.json&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">regions</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="k">print</span> <span class="n">regions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="k">print</span> <span class="n">regions</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">u&#39;West&#39;</span><span class="p">,</span> <span class="s1">u&#39;Northeast&#39;</span><span class="p">,</span> <span class="s1">u&#39;Midwest&#39;</span><span class="p">,</span> <span class="s1">u&#39;South&#39;</span><span class="p">]</span>
<span class="p">[[</span><span class="s1">u&#39;Arizona&#39;</span><span class="p">,</span> <span class="s1">u&#39;Colorado&#39;</span><span class="p">,</span> <span class="s1">u&#39;Idaho&#39;</span><span class="p">,</span> <span class="s1">u&#39;Montana&#39;</span><span class="p">,</span> <span class="s1">u&#39;Nevada&#39;</span><span class="p">,</span> <span class="s1">u&#39;New Mexico&#39;</span><span class="p">,</span> <span class="s1">u&#39;Utah&#39;</span><span class="p">,</span> <span class="s1">u&#39;Wyoming&#39;</span><span class="p">,</span> <span class="s1">u&#39;Alaska&#39;</span><span class="p">,</span> <span class="s1">u&#39;California&#39;</span><span class="p">,</span> <span class="s1">u&#39;Hawaii&#39;</span><span class="p">,</span> <span class="s1">u&#39;Oregon&#39;</span><span class="p">,</span> <span class="s1">u&#39;Washington&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">u&#39;Connecticut&#39;</span><span class="p">,</span> <span class="s1">u&#39;Maine&#39;</span><span class="p">,</span> <span class="s1">u&#39;Massachusetts&#39;</span><span class="p">,</span> <span class="s1">u&#39;New Hampshire&#39;</span><span class="p">,</span> <span class="s1">u&#39;Rhode Island&#39;</span><span class="p">,</span> <span class="s1">u&#39;Vermont&#39;</span><span class="p">,</span> <span class="s1">u&#39;New Jersey&#39;</span><span class="p">,</span> <span class="s1">u&#39;New York&#39;</span><span class="p">,</span> <span class="s1">u&#39;Pennsylvania&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">u&#39;Illinois&#39;</span><span class="p">,</span> <span class="s1">u&#39;Indiana&#39;</span><span class="p">,</span> <span class="s1">u&#39;Michigan&#39;</span><span class="p">,</span> <span class="s1">u&#39;Ohio&#39;</span><span class="p">,</span> <span class="s1">u&#39;Wisconsin&#39;</span><span class="p">,</span> <span class="s1">u&#39;Iowa&#39;</span><span class="p">,</span> <span class="s1">u&#39;Kansas&#39;</span><span class="p">,</span> <span class="s1">u&#39;Minnesota&#39;</span><span class="p">,</span> <span class="s1">u&#39;Missouri&#39;</span><span class="p">,</span> <span class="s1">u&#39;Nebraska&#39;</span><span class="p">,</span> <span class="s1">u&#39;North Dakota&#39;</span><span class="p">,</span> <span class="s1">u&#39;South Dakota&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">u&#39;Delaware&#39;</span><span class="p">,</span> <span class="s1">u&#39;Florida&#39;</span><span class="p">,</span> <span class="s1">u&#39;Georgia&#39;</span><span class="p">,</span> <span class="s1">u&#39;Maryland&#39;</span><span class="p">,</span> <span class="s1">u&#39;North Carolina&#39;</span><span class="p">,</span> <span class="s1">u&#39;South Carolina&#39;</span><span class="p">,</span> <span class="s1">u&#39;Virginia&#39;</span><span class="p">,</span> <span class="s1">u&#39;District of Columbia&#39;</span><span class="p">,</span> <span class="s1">u&#39;West Virginia&#39;</span><span class="p">,</span> <span class="s1">u&#39;Alabama&#39;</span><span class="p">,</span> <span class="s1">u&#39;Kentucky&#39;</span><span class="p">,</span> <span class="s1">u&#39;Mississippi&#39;</span><span class="p">,</span> <span class="s1">u&#39;Tennessee&#39;</span><span class="p">,</span> <span class="s1">u&#39;Arkansas&#39;</span><span class="p">,</span> <span class="s1">u&#39;Louisiana&#39;</span><span class="p">,</span> <span class="s1">u&#39;Oklahoma&#39;</span><span class="p">,</span> <span class="s1">u&#39;Texas&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">df_region</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
    <span class="n">_dftmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span> <span class="n">regions</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span>  <span class="p">)</span>
    <span class="n">_dftmp</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
    <span class="n">df_region</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_dftmp</span><span class="p">)</span>

<span class="n">df_region</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_region</span><span class="p">,</span><span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">df_region</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arizona</td>
      <td>West</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Colorado</td>
      <td>West</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Idaho</td>
      <td>West</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Montana</td>
      <td>West</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nevada</td>
      <td>West</td>
    </tr>
  </tbody>
</table>
</div><p>Let&#8217;s use a hash-table (source) to map state name to its abbreviation</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">util</span> <span class="kn">import</span> <span class="n">hash_state_to_abbrev</span>
<span class="n">hash_state</span> <span class="o">=</span> <span class="n">hash_state_to_abbrev</span><span class="p">()</span>

<span class="n">df_region</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_region</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">key</span><span class="p">:</span> <span class="n">hash_state</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
<span class="n">df_region</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AZ</td>
      <td>West</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CO</td>
      <td>West</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ID</td>
      <td>West</td>
    </tr>
    <tr>
      <th>3</th>
      <td>MT</td>
      <td>West</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NV</td>
      <td>West</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># good, we&#39;re now ready to join this &quot;Region&quot; information to our lookup table</span>
<span class="n">df_lookup</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_region</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="n">df_lookup</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Code</th>
      <th>Description</th>
      <th>Airport</th>
      <th>City</th>
      <th>State</th>
      <th>Region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10135</td>
      <td>Allentown/Bethlehem/Easton, PA: Lehigh Valley ...</td>
      <td>Lehigh Valley International</td>
      <td>Allentown/Bethlehem/Easton</td>
      <td>PA</td>
      <td>Northeast</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10136</td>
      <td>Abilene, TX: Abilene Regional</td>
      <td>Abilene Regional</td>
      <td>Abilene</td>
      <td>TX</td>
      <td>South</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10140</td>
      <td>Albuquerque, NM: Albuquerque International Sun...</td>
      <td>Albuquerque International Sunport</td>
      <td>Albuquerque</td>
      <td>NM</td>
      <td>West</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10141</td>
      <td>Aberdeen, SD: Aberdeen Regional</td>
      <td>Aberdeen Regional</td>
      <td>Aberdeen</td>
      <td>SD</td>
      <td>Midwest</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10146</td>
      <td>Albany, GA: Southwest Georgia Regional</td>
      <td>Southwest Georgia Regional</td>
      <td>Albany</td>
      <td>GA</td>
      <td>South</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10154</td>
      <td>Nantucket, MA: Nantucket Memorial</td>
      <td>Nantucket Memorial</td>
      <td>Nantucket</td>
      <td>MA</td>
      <td>Northeast</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10155</td>
      <td>Waco, TX: Waco Regional</td>
      <td>Waco Regional</td>
      <td>Waco</td>
      <td>TX</td>
      <td>South</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10157</td>
      <td>Arcata/Eureka, CA: Arcata</td>
      <td>Arcata</td>
      <td>Arcata/Eureka</td>
      <td>CA</td>
      <td>West</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10158</td>
      <td>Atlantic City, NJ: Atlantic City International</td>
      <td>Atlantic City International</td>
      <td>Atlantic City</td>
      <td>NJ</td>
      <td>Northeast</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10165</td>
      <td>Adak Island, AK: Adak</td>
      <td>Adak</td>
      <td>Adak Island</td>
      <td>AK</td>
      <td>West</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="add-airport-latitude-and-longitude-information-using-geocoder">
<h3>Add airport latitude and longitude information using geocoder</h3>
<p>Next we&#8217;ll query the geograhical location of each airport using
geocoders from <code class="docutils literal"><span class="pre">geopy</span></code>
(<a class="reference external" href="https://geopy.readthedocs.io/en/1.10.0/">link</a>).</p>
<p>This information will be useful especially when creating visualization
plots.</p>
<p>The cell below is going to take a while, so good time to brew a
coffee... (need to add breaks between API requests to avoid getting
timed-out)</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geopy.geocoders</span> <span class="kn">import</span> <span class="n">Nominatim</span>
<span class="n">geolocator</span> <span class="o">=</span> <span class="n">Nominatim</span><span class="p">()</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span> <span class="p">[],[]</span>
<span class="n">n_items</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">airport</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;Airport&#39;</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">20</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
         <span class="k">print</span> <span class="s1">&#39;({:3} out of {})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">n_items</span><span class="p">),</span><span class="n">print_time</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="n">loc</span> <span class="o">=</span> <span class="n">geolocator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">airport</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># add break to avoid api service timeouts</span>

    <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">lon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">lat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;    lookup failed for: &#39;</span> <span class="o">+</span> <span class="n">airport</span>
        <span class="n">lon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">lat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span>(  0 out of 334) Elapsed time:  0.00 seconds
( 20 out of 334) Elapsed time: 410.26 seconds
    lookup failed for: Western Neb. Regional/William B. Heilig Field
    lookup failed for: Greater Binghamton/Edwin A. Link Field
( 40 out of 334) Elapsed time: 818.81 seconds
    lookup failed for: Boise Air Terminal
    lookup failed for: Brownsville South Padre Island International
    lookup failed for: Baltimore/Washington International Thurgood Marshall
    lookup failed for: Akron-Canton Regional
( 60 out of 334) Elapsed time: 1227.76 seconds
    lookup failed for: Charleston AFB/International
    lookup failed for: Casper/Natrona County International
( 80 out of 334) Elapsed time: 1636.89 seconds
    lookup failed for: Dickinson - Theodore Roosevelt Regional
(100 out of 334) Elapsed time: 2045.76 seconds
    lookup failed for: Northwest Florida Beaches International
    lookup failed for: Erie International/Tom Ridge Field
(120 out of 334) Elapsed time: 2454.87 seconds
    lookup failed for: Green Bay Austin Straubel International
    lookup failed for: Robert Gray AAF
(140 out of 334) Elapsed time: 2863.93 seconds
    lookup failed for: Huntsville International-Carl T Jones Field
(160 out of 334) Elapsed time: 3273.42 seconds
    lookup failed for: Falls International Einarson Field
    lookup failed for: Jackson Medgar Wiley Evers International
(180 out of 334) Elapsed time: 3682.23 seconds
    lookup failed for: Lafayette Regional Paul Fournet Field
    lookup failed for: Bill and Hillary Clinton Nat Adams Field
(200 out of 334) Elapsed time: 4090.87 seconds
(220 out of 334) Elapsed time: 4499.89 seconds
    lookup failed for: Modesto City-County-Harry Sham Field
    lookup failed for: Dane County Regional-Truax Field
    lookup failed for: Louis Armstrong New Orleans International
(240 out of 334) Elapsed time: 4908.80 seconds
    lookup failed for: Newport News/Williamsburg International
(260 out of 334) Elapsed time: 5317.79 seconds
    lookup failed for: Petersburg James A Johnson
    lookup failed for: Theodore Francis Green State
    lookup failed for: Roanoke Blacksburg Regional Woodrum Field
    lookup failed for: Roswell International Air Center
(280 out of 334) Elapsed time: 5727.01 seconds
    lookup failed for: San Angelo Regional/Mathis Field
    lookup failed for: Santa Maria Public/Capt. G. Allan Hancock Field
(300 out of 334) Elapsed time: 6135.91 seconds
    lookup failed for: Francisco C. Ada Saipan International
    lookup failed for: Sheppard AFB/Wichita Falls Municipal
    lookup failed for: Sioux Gateway/Col. Bud Day Field
    lookup failed for: Tri-Cities Regional TN/VA
(320 out of 334) Elapsed time: 6544.53 seconds
    lookup failed for: Joslin Field - Magic Valley Regional
    lookup failed for: Texarkana Regional-Webb Field
    lookup failed for: Eglin AFB Destin Fort Walton Beach
    lookup failed for: Yuma MCAS/Yuma International
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># add as new columns</span>
<span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat</span>
<span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon</span>

<span class="n">n_nans</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;-- {} NANs out {} ({:.2f}%) --&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_nans</span><span class="p">,</span><span class="n">n_items</span><span class="p">,</span><span class="n">n_nans</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n_items</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span>-- 36 NANs out 334 (10.78%) --
</pre></div>
</div>
<ul class="simple">
<li>So some lookup failed...but most succeeded</li>
<li>For airports that failed, search using City + State information (lose
locality a bit but will suffice for our analysis)</li>
</ul>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">idx_nan</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># keep track of the index location that may fail yet again</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">n_items</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">i</span><span class="p">,</span>
    <span class="k">if</span> <span class="n">lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">city</span><span class="p">,</span><span class="n">state</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">geolocator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">city</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="n">state</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># add break to avoid api service timeouts</span>

    <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">lon</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;    lookup failed for: {}, {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">city</span><span class="p">,</span><span class="n">state</span><span class="p">)</span>
        <span class="n">idx_nan</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span>0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248     lookup failed for: Newport News/Williamsburg, VA
249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302     lookup failed for: Saipan, TT
303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># update columns</span>
<span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat</span>
<span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon</span>

<span class="n">n_nans</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;-- {} NANs out {} ({:.2f}%) --&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_nans</span><span class="p">,</span><span class="n">n_items</span><span class="p">,</span><span class="n">n_nans</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n_items</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span>-- 2 NANs out 334 (0.60%) --
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">df_lookup</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;df_lookup_tmp.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>So at this point, we have two lookup failures</li>
<li>Although unelegant, I&#8217;ll just manually query these in the geocoder</li>
</ul>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">idx_nan</span>
<span class="n">df_lookup</span><span class="p">[</span><span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">248</span><span class="p">,</span> <span class="mi">302</span><span class="p">]</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Code</th>
      <th>Description</th>
      <th>Airport</th>
      <th>City</th>
      <th>State</th>
      <th>Region</th>
      <th>lat</th>
      <th>lon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>248</th>
      <td>14098</td>
      <td>Newport News/Williamsburg, VA: Newport News/Wi...</td>
      <td>Newport News/Williamsburg International</td>
      <td>Newport News/Williamsburg</td>
      <td>VA</td>
      <td>South</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>302</th>
      <td>14955</td>
      <td>Saipan, TT: Francisco C. Ada Saipan International</td>
      <td>Francisco C. Ada Saipan International</td>
      <td>Saipan</td>
      <td>TT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span> <span class="o">=</span> <span class="n">geolocator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="s1">&#39;Newport News, VA&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">248</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat</span>
<span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">248</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon</span>

<span class="n">lat</span><span class="p">,</span><span class="n">lon</span> <span class="o">=</span> <span class="n">geolocator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="s1">&#39;Saipan&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">302</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat</span>
<span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">302</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon</span>

<span class="k">print</span> <span class="n">df_lookup</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span>Code           0
Description    0
Airport        0
City           0
State          0
Region         8
lat            0
lon            0
dtype: int64
</pre></div>
</div>
</div>
<div class="section" id="add-column-with-both-city-and-state">
<h3>Add column with both city and state</h3>
<ul class="simple">
<li>Since I am not familiar with many names of the airport, I&#8217;d rather
work with City and State names.</li>
<li>However, there may be multiple airports in the same city (eg, JKF and
Laguardia in NYC), so uniqueness of &#8220;City/State&#8221; is not guaranteed.</li>
<li>Here, I&#8217;ll create yet another (and final) column containing both the
City and State information, and modify duplicates as needed.</li>
</ul>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;City_State&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>

<span class="n">df_lookup</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Code</th>
      <th>Description</th>
      <th>Airport</th>
      <th>City</th>
      <th>State</th>
      <th>Region</th>
      <th>lat</th>
      <th>lon</th>
      <th>City_State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>269</th>
      <td>14520</td>
      <td>Rhinelander, WI: Rhinelander/Oneida County</td>
      <td>Rhinelander/Oneida County</td>
      <td>Rhinelander</td>
      <td>WI</td>
      <td>Midwest</td>
      <td>-89.412075</td>
      <td>45.636623</td>
      <td>Rhinelander (WI)</td>
    </tr>
    <tr>
      <th>160</th>
      <td>12320</td>
      <td>Wilmington, DE: New Castle</td>
      <td>New Castle</td>
      <td>Wilmington</td>
      <td>DE</td>
      <td>South</td>
      <td>-80.347009</td>
      <td>41.003672</td>
      <td>Wilmington (DE)</td>
    </tr>
    <tr>
      <th>322</th>
      <td>15401</td>
      <td>Texarkana, AR: Texarkana Regional-Webb Field</td>
      <td>Texarkana Regional-Webb Field</td>
      <td>Texarkana</td>
      <td>AR</td>
      <td>South</td>
      <td>-94.037692</td>
      <td>33.441795</td>
      <td>Texarkana (AR)</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10577</td>
      <td>Binghamton, NY: Greater Binghamton/Edwin A. Li...</td>
      <td>Greater Binghamton/Edwin A. Link Field</td>
      <td>Binghamton</td>
      <td>NY</td>
      <td>Northeast</td>
      <td>-75.914341</td>
      <td>42.096968</td>
      <td>Binghamton (NY)</td>
    </tr>
    <tr>
      <th>212</th>
      <td>13303</td>
      <td>Miami, FL: Miami International</td>
      <td>Miami International</td>
      <td>Miami</td>
      <td>FL</td>
      <td>South</td>
      <td>-80.376289</td>
      <td>25.755338</td>
      <td>Miami (FL)</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># check duplicates in &quot;City_State&quot;</span>
<span class="n">dups</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;City_State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">dups</span> <span class="o">=</span> <span class="n">dups</span><span class="p">[</span><span class="n">dups</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">dups</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span>Houston (TX)       3
Chicago (IL)       2
Washington (DC)    2
New York (NY)      2
Name: City_State, dtype: int64
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># create hash-table for airport name lookup</span>
<span class="n">hash_airport</span> <span class="o">=</span> <span class="n">df_lookup</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Code&#39;</span><span class="p">)[</span><span class="s1">&#39;Airport&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">pprint</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">hash_airport</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">hash_airport</span><span class="o">.</span><span class="n">keys</span><span class="p">()[:</span><span class="mi">5</span><span class="p">]})</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">10245</span><span class="p">:</span> <span class="s1">&#39;King Salmon Airport&#39;</span><span class="p">,</span>
 <span class="mi">10754</span><span class="p">:</span> <span class="s1">&#39;Wiley Post/Will Rogers Memorial&#39;</span><span class="p">,</span>
 <span class="mi">11267</span><span class="p">:</span> <span class="s1">&#39;James M Cox/Dayton International&#39;</span><span class="p">,</span>
 <span class="mi">13830</span><span class="p">:</span> <span class="s1">&#39;Kahului Airport&#39;</span><span class="p">,</span>
 <span class="mi">14696</span><span class="p">:</span> <span class="s1">&#39;South Bend International&#39;</span><span class="p">}</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># check duplicates in &quot;City_State&quot;</span>
<span class="k">for</span> <span class="n">dup</span> <span class="ow">in</span> <span class="n">dups</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">dup</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_lookup</span><span class="p">[</span><span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;City_State&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dup</span><span class="p">]</span><span class="o">.</span><span class="n">Code</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;    (Code = {:6}) Airport = {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">df_data</span><span class="p">[</span><span class="s1">&#39;ORIGIN_AIRPORT_ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">hash_airport</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span>Houston (TX)
    (Code =      1) Airport = Ellington
    (Code = 171407) Airport = William P Hobby
    (Code = 478137) Airport = George Bush Intercontinental/Houston
Chicago (IL)
    (Code = 264913) Airport = Chicago Midway International
    (Code = 853523) Airport = Chicago O&#39;Hare International
Washington (DC)
    (Code = 230760) Airport = Ronald Reagan Washington National
    (Code = 135697) Airport = Washington Dulles International
New York (NY)
    (Code = 302634) Airport = John F. Kennedy International
    (Code = 314816) Airport = LaGuardia
</pre></div>
</div>
<p>Again, kinda hacky, but will create manual replacement on these
duplicates using the &#8220;cleaner&#8221; below</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">cleaner</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Houston (TX) [Ell]&#39;</span><span class="p">,</span> <span class="s1">&#39;Ellington&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Houston (TX) [WP.Hobby]&#39;</span><span class="p">,</span> <span class="s1">&#39;William P Hobby&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Houston (TX) [G.Bush]&#39;</span><span class="p">,</span>  <span class="s1">&#39;George Bush Intercontinental/Houston&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Chicago (IL) [Midway]&#39;</span><span class="p">,</span>   <span class="s1">&#39;Chicago Midway International&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Chicago (IL) [O&#39;Hare]&quot;</span><span class="p">,</span>   <span class="s2">&quot;Chicago O&#39;Hare International&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Washington (DC) [R.Reagan]&#39;</span><span class="p">,</span>   <span class="s1">&#39;Ronald Reagan Washington National&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Washington (DC) [W.Dulles]&#39;</span><span class="p">,</span>   <span class="s1">&#39;Washington Dulles International&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;New York (NY) [JFK]&quot;</span><span class="p">,</span>   <span class="s2">&quot;John F. Kennedy International&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;New York (NY) [Lag]&quot;</span><span class="p">,</span>   <span class="s2">&quot;LaGuardia&quot;</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">_replace</span><span class="p">,</span> <span class="n">_airport</span> <span class="ow">in</span> <span class="n">cleaner</span><span class="p">:</span>
    <span class="n">df_lookup</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;Airport&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">_airport</span><span class="p">,</span> <span class="s1">&#39;City_State&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_replace</span>

<span class="c1"># check duplicates are removed</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">df_lookup</span><span class="p">[</span><span class="s1">&#39;City_State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="all-done-save-dataframe-on-disk">
<h2>All done. Save dataframe on disk</h2>
<ul class="simple">
<li>We have created our <em>enhanced</em> lookup table.</li>
<li>Let&#8217;s save this on disk for later analysis.</li>
</ul>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">df_lookup</span><span class="o">.</span><span class="n">shape</span>
<span class="n">df_lookup</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
<div class="myliteral highlight-python"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">334</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Code</th>
      <th>Description</th>
      <th>Airport</th>
      <th>City</th>
      <th>State</th>
      <th>Region</th>
      <th>lat</th>
      <th>lon</th>
      <th>City_State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>10208</td>
      <td>Augusta, GA: Augusta Regional at Bush Field</td>
      <td>Augusta Regional at Bush Field</td>
      <td>Augusta</td>
      <td>GA</td>
      <td>South</td>
      <td>-81.965064</td>
      <td>33.372302</td>
      <td>Augusta (GA)</td>
    </tr>
    <tr>
      <th>25</th>
      <td>10434</td>
      <td>Scranton/Wilkes-Barre, PA: Wilkes Barre Scrant...</td>
      <td>Wilkes Barre Scranton International</td>
      <td>Scranton/Wilkes-Barre</td>
      <td>PA</td>
      <td>Northeast</td>
      <td>-75.722549</td>
      <td>41.337135</td>
      <td>Scranton/Wilkes-Barre (PA)</td>
    </tr>
    <tr>
      <th>42</th>
      <td>10721</td>
      <td>Boston, MA: Logan International</td>
      <td>Logan International</td>
      <td>Boston</td>
      <td>MA</td>
      <td>Northeast</td>
      <td>-77.030034</td>
      <td>38.893329</td>
      <td>Boston (MA)</td>
    </tr>
    <tr>
      <th>112</th>
      <td>11624</td>
      <td>Key West, FL: Key West International</td>
      <td>Key West International</td>
      <td>Key West</td>
      <td>FL</td>
      <td>South</td>
      <td>-81.756229</td>
      <td>24.554654</td>
      <td>Key West (FL)</td>
    </tr>
    <tr>
      <th>120</th>
      <td>11721</td>
      <td>Flint, MI: Bishop International</td>
      <td>Bishop International</td>
      <td>Flint</td>
      <td>MI</td>
      <td>Midwest</td>
      <td>-1.516735</td>
      <td>52.407220</td>
      <td>Flint (MI)</td>
    </tr>
    <tr>
      <th>154</th>
      <td>12255</td>
      <td>Hays, KS: Hays Regional</td>
      <td>Hays Regional</td>
      <td>Hays</td>
      <td>KS</td>
      <td>Midwest</td>
      <td>-99.273037</td>
      <td>38.845476</td>
      <td>Hays (KS)</td>
    </tr>
    <tr>
      <th>205</th>
      <td>13241</td>
      <td>Meridian, MS: Key Field</td>
      <td>Key Field</td>
      <td>Meridian</td>
      <td>MS</td>
      <td>South</td>
      <td>-0.833914</td>
      <td>53.690169</td>
      <td>Meridian (MS)</td>
    </tr>
    <tr>
      <th>230</th>
      <td>13577</td>
      <td>Myrtle Beach, SC: Myrtle Beach International</td>
      <td>Myrtle Beach International</td>
      <td>Myrtle Beach</td>
      <td>SC</td>
      <td>South</td>
      <td>-78.929060</td>
      <td>33.680641</td>
      <td>Myrtle Beach (SC)</td>
    </tr>
    <tr>
      <th>277</th>
      <td>14635</td>
      <td>Fort Myers, FL: Southwest Florida International</td>
      <td>Southwest Florida International</td>
      <td>Fort Myers</td>
      <td>FL</td>
      <td>South</td>
      <td>-80.376289</td>
      <td>25.755338</td>
      <td>Fort Myers (FL)</td>
    </tr>
    <tr>
      <th>285</th>
      <td>14709</td>
      <td>Deadhorse, AK: Deadhorse Airport</td>
      <td>Deadhorse Airport</td>
      <td>Deadhorse</td>
      <td>AK</td>
      <td>West</td>
      <td>-148.465705</td>
      <td>70.195843</td>
      <td>Deadhorse (AK)</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">df_lookup</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;df_lookup.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>